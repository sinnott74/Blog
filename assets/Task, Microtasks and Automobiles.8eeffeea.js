var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;import"./vendor.f315bbe5.js";import{N as s}from"./mdx-react.modern.e61303d7.js";const r="Task, Microtasks & Automobiles",i="Daniel Sinnott",l="https://i.imgur.com/BywnfLd.png",p=7,c=["Javascript","Concurrency"],u="Mon, 19th Feb 2018",h=new Date(1519051903729);function m(e){var r=e,{components:i}=r,l=((e,a)=>{var s={};for(var r in e)n.call(e,r)&&a.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&t)for(var r of t(e))a.indexOf(r)<0&&o.call(e,r)&&(s[r]=e[r]);return s})(r,["components"]);return s("wrapper",((e,s)=>{for(var r in s||(s={}))n.call(s,r)&&a(e,r,s[r]);if(t)for(var r of t(s))o.call(s,r)&&a(e,r,s[r]);return e})({components:i},l),s("p",null,"This blog post is based largely on Jake Archibald's (",s("a",{href:"https://twitter.com/jaffathecake",parentName:"p"},"@jaffathecake"),") talk ",s("a",{href:"https://www.youtube.com/watch?v=cCOL7MC4Pl0",parentName:"p"},"In The Loop")),s("h2",null,"The Event Loop"),s("p",null,"The event loop is how Javascript implements its concurrency model and allows it to perform multiple\nnon blocking asynchronous operations despite the fact that it is single threaded. Each javascript\nthread gets it's own event loop. i.e. both the main thread & web workers get their own event loop as\nthey are executed in their own thread."),s("p",null,"The event loop runs continually round executing tasks, mircotasks & even performing all render steps\nlike style calculations, layout & paint."),s("p",null,"Note: Its possible for Pages to share an single event loop when they are on the same origin. This\nallows them to synchronously communicate. Examples of opening pages on the same origin are iframes,\nwindow.frames & pages opened with window.open(). Window.postMessage() can then be used to\ncommunicate from page to page. However opening a page with window.open() & passing the noopener\noption will prevent the child page from referencing the parent and also give it its own event loop.\nFor more info see: ",s("a",{href:"http://hassansin.github.io/shared-event-loop-among-same-origin-windows",parentName:"p"},"Shared Event-loop for Same-Origin Windows")),s("h2",null,"Tasks"),s("p",null,"A task is a unit of work scheduled by the browser. Tasks are put into a task queue to ensure they\nare executed in the correct order, and can be put there from multiple sources. Examples of tasks\ninclude setTimeout & event clicks."),s("p",null,"Each iteration of the event loop will perform a single task, to completion. The thread is completely\nfocused on completing this task. Long running tasks block page rendering and can cause the user to\nnotice that the page is frozen."),s("p",null,"Tasks can queue other tasks, but as only a single task can be completed on each loop the browser is\nallowed to perform rendering in between tasks. A good example of this is setTimeout recursively\nqueue setTimeouts. This doesn't block rendering."),s("h2",null,"Microtasks"),s("p",null,"Microtasks are very similars to tasks. Like tasks, they are also placed in a queue by multiple\nsources. However microtasks position in the event loop is somewhat fluid. The event loop executes\nmicrotasks whenever the javascript callstack is empty. Which means microtasks can be executed after\na task or even after a Request Animation Frame callback."),s("p",null,"Like Tasks Microtasks can queue other microtasks, but unlike tasks they are completed until the\nqueue is empty. This means recursive microtasks can block rendering."),s("p",null,"Examples of microtasks include process.nextTick & Promises."),s("h2",null,"Render Steps"),s("p",null,"The browser controls when the render steps are executed. It notifies the event loop that on the next\niteration of the loop it should perform Style calculations, Layout & finally Paint the pixels on the\nscreen. It aims to do this typically every 16.6ms or 60 frames per second."),s("h3",null,"Request Animation Frame"),s("p",null,"Request Animation Frame (rAF) callbacks are called during the render steps, just before style\ncalculations. Its an ideal place to perform UI specific updates & allows the batching of updates."),s("p",null,"rAF callbacks are executed until completion, including queued rAFs. However, the browser will take a\nbreak from executing queued rAFs when it hits a rAf which wasn't queued before this iteration of the\nloop."),s("h2",null,"Visuals"),s("p",null,"Below is a visual representation of The Event Loop. All microtasks on the queue are executed\neverytime the javascript callstack is empty.\n",s("img",{src:"https://i.imgur.com/yp6hsFd.gif",alt:"JavaScript Event Loop",title:"JavaScript Event Loop",parentName:"p"})," Credit to\n(",s("a",{href:"https://twitter.com/jaffathecake",parentName:"p"},"@jaffathecake"),")"))}m.isMDXComponent=!0;export default m;export{i as author,h as created,u as date,p as id,l as imageurl,c as tags,r as title};
